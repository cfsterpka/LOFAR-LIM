from os.path import isdir, dirname, abspath
import numpy as np

class definitions:
  def __init__(self):
      #self.default_raw_data_loc = "/exp_app2/appexp1/public/raw_data"

      self.default_raw_data_loc = "/home/chris/Programs/Lightning/LOFAR/RAW_DATA"
      self.default_processed_data_loc = "/home/chris/Programs/Lightning/LOFAR/processed_files"
      self.MetaData_directory =  dirname(abspath(__file__)) + '/data' ## change this if antenna_response_model is in a folder different from this module
      self.window_width =5E-6
                                 ## ^^ this command finds the path of utilities.py, not the path of where utilties.py happens to have been executed.
      self.timeID = "D20180809T141413.250Z"
      self.block_size = 2**16
      self.num_blocks = 10
      #self.bad_stations = ["RS205","RS210","RS509"]

      '''

      #self.source_locations = {0 :[  -29811.398103552805 , -7064.275250752117 , 5266.435001565184 , 1.286093861848703  ]}
      #self.source_locations = {0 :[  -29748.800354316383 , -7078.125833397102 , 5055.249207646643 , 1.2860941685454563  ]}

       #fit 0

      self.source_locations = { 0 :[-29715.239081599037 , -7269.307480076134 , 5211.223464631507 , 1.2860940423173264  ],} #7.25E-10
      self.known_sources = [0]
      #self.initial_block = 3160 #---1.03555
      #self.guess_source_location = 1.0355581479894433
      self.initial_block = 3920
      self.guess_timing = self.source_locations[0][3]
      self.bad_stations = ["RS205","RS210", "CS028", "RS106", "RS306" ]
      self.fitter = "dt"
      self.event_index = 0
      self.known_polarizations = {0: 0}
      self.stations_to_exclude = {0:[],}
      self.antennas_to_exclude = {0:[],}
      self.bad_antennas = []
      self.reference_station = 'CS002'
      self.bad_antennas = []
      self.guess_station_delays = {
"CS001": 0.0004980878050500645,
"CS002": 0.0,
"CS003": 0.0002879175743611548,
"CS004": 0.0006400826505794945,
"CS006": 0.0006460103229564806,
"CS005": 0.0006397901894196267,
"CS011": 0.00035863514704485773,
"CS007": 0.000569194218680948,
"CS013": 0.000643111604983777,
"CS017": 0.00012637601743114538,
"CS021": 0.0006398319965082136,
"CS024": 0.0006429433624816645,
"CS026": 0.0001422519963407144,
#"RS305": 0.0006302195929104107,
"RS409": 0.0006029709451341713,
"CS032": 0.0006362371164140604,
"CS030": 0.0006363086268564308,
"CS103": 0.0006226613212892918,
"CS201": 0.0006373363517870894,
"CS301": 0.000643372947119162,
"CS302": 0.00063442809475871,
"CS401": 0.0006361088583872743,
"CS501": 0.0006307715673071388,
#"RS106": 0.0006702877185066088,
"RS208": 0.0006792664033370419,
#"RS306": 0.0006179450247087899,
"RS310": 0.0002658618409479834,
"RS307": 0.0003800809389208849,
"RS406": 0.0004768872833302363,
"RS407": 0.0006654480001927022,
"RS503": 0.0006514014852824324,
"RS508": 0.0007311560132705774,

"RS205": 0.0006503209162534441,

      }
#"CS028": 0.0006322911598035739,
#"RS210": 0.00045996009448966846,
#"RS509": 0.0002498553584549821,
#}

      self.fitted_delays = {
      #real delays from fitter2:
'CS001' :  2.222179236034346e-06 , ## diff to guess: -0.0004958656258140302
'CS003' :  1.406080985210027e-06 , ## diff to guess: -0.00028651149337594474
'CS004' :  4.2952474952427016e-07 , ## diff to guess: -0.0006396531258299703
'CS006' :  4.328970580348795e-07 , ## diff to guess: -0.0006455774258984457
'CS005' :  -2.205877614897405e-07 , ## diff to guess: -0.0006400107771811164
'CS011' :  -5.872400919027286e-07 , ## diff to guess: -0.00035922238713676044
'CS007' :  4.0089154931859974e-07 , ## diff to guess: -0.0005687933271316293
'CS013' :  -1.809355445092195e-06 , ## diff to guess: -0.0006449209604288691
'CS017' :  -8.438527113156883e-06 , ## diff to guess: -0.00013481454454430226
'CS021' :  9.283114576553579e-07 , ## diff to guess: -0.0006389036850505583
'CS024' :  2.310294984450343e-06 , ## diff to guess: -0.0006406330674972141
'CS026' :  -9.233579092598853e-06 , ## diff to guess: -0.00015148557543331325
'RS305' :  6.890094136689885e-06 , ## diff to guess: -0.0006233294987737207
'RS409' :  7.489017221176312e-06 , ## diff to guess: -0.0005954819279129951
'CS032' :  -1.5779577786448236e-06 , ## diff to guess: -0.0006378150741927052
'CS030' :  -2.732303953969715e-06 , ## diff to guess: -0.0006390409308104006
'CS103' :  -2.8518648725820313e-05 , ## diff to guess: -0.0006511799700151121
'CS201' :  -1.0489238664704718e-05 , ## diff to guess: -0.0006478255904517941
'CS301' :  -7.329873594460002e-07 , ## diff to guess: -0.000644105934478608
'CS302' :  -5.3741462733768005e-06 , ## diff to guess: -0.0006398022410320868
'CS401' :  -9.523646309905877e-07 , ## diff to guess: -0.0006370612230182648
'CS501' :  -9.593903998431482e-06 , ## diff to guess: -0.0006403654713055703
'RS106' :  6.963705356341262e-06 , ## diff to guess: -0.0006633240131502675
'RS208' :  6.793679788062527e-06 , ## diff to guess: -0.0006724727235489794
'RS306' :  6.972452986914023e-06 , ## diff to guess: -0.0006109725717218759
'RS310' :  7.399524263370669e-06 , ## diff to guess: -0.0002584623166846127
'RS307' :  6.718955046504604e-06 , ## diff to guess: -0.0003733619838743803
'RS406' :  7.176229962100059e-06 , ## diff to guess: -0.00046971105336813623
'RS407' :  7.340313735854319e-06 , ## diff to guess: -0.0006581076864568479
'RS503' :  6.996389573373683e-06 , ## diff to guess: -0.0006444050957090588
'RS508' :  7.342122415080782e-06  ## diff to guess: -0.0007238138908554966
}

      '''

      '''
#fit1
      self.source_locations = { 0 :[ -29715.239081599037 , -7269.307480076134 , 5211.223464631507 , 1.2860940423173264  ],
                                10 :[ -29136.67231640007 , -6802.160202536559 , 5965.013574251614 , 1.2816623342506788 ],  #RMS=1.01E-09


                              }
      self.guess_timing = 1.2816612676563326
      self.known_sources = [10]
      self.event_index = 1
      #self.initial_block = 3160 #---1.03555
      #self.guess_source_location = 1.0355581479894433
      self.initial_block = int(   self.guess_timing /((2**16)*(5.0E-9)) - 7  )
      print('setting initial block to: ' + str(self.initial_block))
      self.bad_stations = ["RS205","RS210", "CS028" ,  'RS509'
"CS021","RS306","CS301","RS106","RS409","RS307","RS310"]

      self.known_polarizations = {10: 0}
      self.stations_to_exclude = {10:[],}
      self.antennas_to_exclude = {10:[],}
      self.bad_antennas = []
      self.reference_station = 'CS002'
      self.fitter = "dt"
      self.bad_antennas = []

      self.guess_station_delays = {
"CS001": 0.0004981162257297631,
"CS002": 0.0,
"CS003": 0.00028805546267947373,
"CS004": 0.0006400962712718463,
"CS005": 0.0006399055937532716,
"CS006": 0.0006459823839321643,
"CS007": 0.000569163654434703,
"CS011": 0.00035845278430605905,
"CS013": 0.0006428639484775855,
"CS017": 0.00012634367427532514,
"CS024": 0.000642748773266812,
"CS026": 0.00014200849662887604,
"CS030": 0.0006361003025592846,
"CS032": 0.0006361817985301202,
"CS103": 0.0006224135583754398,
"CS201": 0.0006371903940759499,
"CS302": 0.000634320226388474,
"CS401": 0.0006359037497813969,
"CS501": 0.0006305191867292579,
"RS208": 0.0005869881881777059,
"RS305": 0.0006300888738459489,
"RS406": 0.00047641971646734233,
"RS407": 0.0006650596498523721,
"RS503": 0.0006512815128217998,
"RS508": 0.0007307176222034628,

#"CS021": 0.0006396401559694257,
#"RS306": 0.0006179925063196552,
#"CS301": 0.0006432605944216831,


#"RS106": 0.00067018154376239,
#"RS409": 0.000893736764873918,
#"RS307": 0.00038198793317250636,
#"RS310": 0.00026714978157846227,
}

      self.fitted_delays = {
'CS001' :  2.22113370648757e-06 , ## diff to guess: -0.0004958950920232755
'CS003' :  1.4033085592330315e-06 , ## diff to guess: -0.0002866521541202407
'CS004' :  4.3046327766342255e-07 , ## diff to guess: -0.0006396658079941828
'CS005' :  -2.2052598773148733e-07 , ## diff to guess: -0.000640126119741003
'CS006' :  4.3306086638613104e-07 , ## diff to guess: -0.0006455493230657782
'CS007' :  4.0151963141151576e-07 , ## diff to guess: -0.0005687621348032915
'CS011' :  -5.841813472451443e-07 , ## diff to guess: -0.0003590369656533042
'CS013' :  -1.8145328481258779e-06 , ## diff to guess: -0.0006446784813257114
'CS017' :  -8.429422931120398e-06 , ## diff to guess: -0.00013477309720644554
'CS024' :  2.3184104966439107e-06 , ## diff to guess: -0.0006404303627701681
'CS026' :  -9.219841116753627e-06 , ## diff to guess: -0.00015122833774562966
'CS030' :  -2.7463502902353587e-06 , ## diff to guess: -0.00063884665284952
'CS032' :  -1.5892434155523716e-06 , ## diff to guess: -0.0006377710419456725
'CS103' :  -2.8492073340417043e-05 , ## diff to guess: -0.0006509056317158568
'CS201' :  -1.0471276900438058e-05 , ## diff to guess: -0.000647661670976388
'CS302' :  -5.387667666929115e-06 , ## diff to guess: -0.0006397078940554032
'CS401' :  -9.715907041175378e-07 , ## diff to guess: -0.0006368753404855144
'CS501' :  -9.608049686155826e-06 , ## diff to guess: -0.0006401272364154137
'RS208' :  -8.583122867546733e-05 , ## diff to guess: -0.0006728194168531732
'RS305' :  6.763978841008539e-06 , ## diff to guess: -0.0006233248950049404
'RS406' :  6.944299912006068e-06 , ## diff to guess: -0.00046947541655533625
'RS407' :  7.147815603262461e-06 , ## diff to guess: -0.0006579118342491096
'RS503' :  6.954566706342879e-06 , ## diff to guess: -0.0006443269461154569
'RS508' :  7.2652468380454215e-06 , ## diff to guess: -0.0007234523753654173

}
      '''


      '''
       #fit 2

      self.event_index = 2

      self.source_locations = {#{ 0 :[-29715.239081599037 , -7269.307480076134 , 5211.223464631507 , 1.2860940423173264  ],

                                #10 :[  21025.47063296452 , -71811.62941023907 , 5318.008358576768 , 1.2337272673939923  ],

                                 20 :[ -27403.49683718821 , -4778.270663263522 , 6108.05202126221 , 1.579733577674917 ], #RMS=9.07E-10

                              }

      self.known_sources = [20]
      self.num_blocks = 10
      #self.guess_timing = self.source_locations[10][3]
      self.window_width = 5E-6
      #self.initial_block = int(   self.guess_timing /((2**16)*(5.0E-9)) - 7  ) +20
      self.bad_stations = ["RS205","RS210","RS509"] #["RS205","RS210", "CS028", "RS106", "RS306" ]

      self.bad_stations += ["CS028","RS106","RS307", "RS409","RS305"]

      self.bad_stations += ["CS021","RS306"]

      self.reference_station = "CS002"

      self.fitter = "dt"
      self.initial_block = 4050
      self.known_polarizations = {20: 0}
      self.stations_to_exclude = {20:[],}
      self.antennas_to_exclude = {20:[],}
      self.bad_antennas = []
      self.guess_timing = 1.3291891867572805
      self.guess_station_delays = {
"CS002": 0.0,
"CS001": 0.0004981623859638417,
"CS003": 0.00028797770760160326,
"CS004": 0.0006400490176362601,
"CS005": 0.0006397988445638685,
"CS006": 0.0006459049537651933,
"CS007": 0.0005689544395157314,
"CS011": 0.00035853005238547825,
"CS013": 0.0006428801372371144,
"CS017": 0.00012622549276863592,
"CS024": 0.0006428875053476091,
"CS401": 0.0006359312060837397,
"CS026": 0.0001420763810988778,
"CS030": 0.0006359175626060076,
"CS032": 0.0006361095901221744,
"CS103": 0.0006224140402888405,
"CS201": 0.0006372570251208275,
"CS301": 0.0006434496384420947,
"CS302": 0.0006345450237545565,
"CS501": 0.0006303009606184942,
"RS208": 0.0006859564532189503,
"RS310": 0.0002851718450617275,
"RS406": 0.00047495855721813355,
"RS407": 0.0006631542226332818,
"RS503": 0.0006506022474676982,
"RS508": 0.0007285526924972868,

#kinda bad:
#"CS021": 0.0006397516053838745,
#"RS306": 0.0006187964612064243,


#bad:
#"RS409": 0.000608954817777547,
#"RS106": 0.0006710318630592986,
#"RS307": 0.0003857232156558586,
#"RS305": 0.0006305979984819884,

#"CS028": 0.0006318678394307349,
}


      self.fitted_delays = {
'CS001' :  2.223599622644152e-06 , ## diff to guess: -0.0004959387863411976
'CS003' :  1.405214649703983e-06 , ## diff to guess: -0.00028657249295189926
'CS004' :  4.319752450255884e-07 , ## diff to guess: -0.0006396170423912345
'CS005' :  -2.2131842701759474e-07 , ## diff to guess: -0.0006400201629908861
'CS006' :  4.3005229056463043e-07 , ## diff to guess: -0.0006454749014746287
'CS007' :  3.9997618703873264e-07 , ## diff to guess: -0.0005685544633286927
'CS011' :  -5.906179696741748e-07 , ## diff to guess: -0.0003591206703551524
'CS013' :  -1.8107515109324e-06 , ## diff to guess: -0.0006446908887480468
'CS017' :  -8.442133496756723e-06 , ## diff to guess: -0.00013466762626539264
'CS021' :  9.281736430017542e-07 , ## diff to guess: -0.0006388234317408727
'CS024' :  2.3098537719252537e-06 , ## diff to guess: -0.0006405776515756838
'CS401' :  -9.468079482290515e-07 , ## diff to guess: -0.0006368780140319687
'CS026' :  -9.24080563808442e-06 , ## diff to guess: -0.00015131718673696223
'CS030' :  -2.732387406527785e-06 , ## diff to guess: -0.0006386499500125355
'CS032' :  -1.573658348729572e-06 , ## diff to guess: -0.0006376832484709039
'CS103' :  -2.853419366833923e-05 , ## diff to guess: -0.0006509482339571797
'CS201' :  -1.0494516250995591e-05 , ## diff to guess: -0.0006477515413718231
'CS301' :  -7.288814156535102e-07 , ## diff to guess: -0.0006441785198577482
'CS302' :  -5.355085485769184e-06 , ## diff to guess: -0.0006399001092403257
'CS501' :  -9.600850728158973e-06 , ## diff to guess: -0.0006399018113466532
'RS208' :  6.897458985185257e-06 , ## diff to guess: -0.000679058994233765
'RS305' :  6.968395620391749e-06 , ## diff to guess: -0.0006236296028615966
'RS310' :  7.836856155950466e-06 , ## diff to guess: -0.00027733498890577705
'RS406' :  7.169349863229731e-06 , ## diff to guess: -0.00046778920735490384
'RS407' :  7.270891285395704e-06 , ## diff to guess: -0.0006558833313478861
'RS503' :  6.987242106430727e-06 , ## diff to guess: -0.0006436150053612675
'RS508' :  7.186312787711282e-06 , ## diff to guess: -0.0007213663797095755
     }



      '''



      ''' #fit 3
      self.event_index = 3

      self.source_locations = { 0 :[-29715.239081599037 , -7269.307480076134 , 5211.223464631507 , 1.2860940423173264  ],
                          10 :[  21025.47063296452 , -71811.62941023907 , 5318.008358576768 , 1.2337272673939923  ],

      20 :[ -27403.49683718821 , -4778.270663263522 , 6108.05202126221 , 1.579733577674917 ],


30 :[ -26344.281919671535 , -2298.7088219885613 , 4952.420136669922 , 1.8962371704442584 ], #RMS=7.50E-10

                        }
      self.reference_station = 'CS002'
      self.known_sources = [30]
      self.num_blocks = 10
      #self.guess_timing = self.source_locations[10][3]
      self.window_width = 5E-6
      self.bad_stations = ["RS205","RS210","RS509"]
      self.bad_stations += ["CS028" "RS409","RS106","RS307", "RS503","RS305"]


      self.fitter = "dt"
      #self.initial_block = 4050
      self.known_polarizations = {30: 0}
      self.stations_to_exclude = {30:[],}
      self.antennas_to_exclude = {30:[],}
      self.bad_antennas = []

      self.initial_block = 5020#int(   self.guess_timing /((2**16)*(5.0E-9)) - 7  ) +20
      self.guess_timing = 1.6456875187495348
      self.guess_station_delays = {
"CS002": 0.0,
"CS001": 0.0004982503995196186,
"CS003": 0.0002878418147033357,
"CS004": 0.0006400604918880311,
"CS005": 0.0006398397789373149,
"CS006": 0.0006459413811551867,
"CS007": 0.0005689561359627143,
"CS011": 0.00035858993578438453,
"CS013": 0.0006427255792438218,
"CS017": 0.00012623944644218587,
"CS024": 0.0006431297098032119,
"CS401": 0.0006358947640485724,
"CS026": 0.00014208884754808408,
"CS030": 0.0006356625935223836,
"CS032": 0.0006361481630829998,
"CS103": 0.0006225149316048088,
"CS201": 0.0006373917110969773,
"CS301": 0.0006437400216036111,
"CS302": 0.0006349016448063567,
"CS501": 0.000630003483055023,
"RS208": 0.000692949490840811,
"RS310": 0.00032919720776137867,
"RS406": 0.00047152902599157157,
"RS407": 0.0006592574641527224,
"RS508": 0.0007247582490380716,
"CS021": 0.0006394976723064202,
"RS306": 0.0006189670138617563,
#"RS409": 0.0006073381196142045,
#"RS106": 0.0006724646045547426,
#"RS307": 0.00039086644969141255,
#"RS305": 0.000630686717269416,
#"CS028": 0.0006315814422032458,
#"RS503": 0.0006495996260220533,

}

      self.fitted_delays ={
'CS001' :  2.2280881274517245e-06 , ## diff to guess: -0.0004960223113921669
'CS003' :  1.4051839184513333e-06 , ## diff to guess: -0.0002864366307848844
'CS004' :  4.308147807068389e-07 , ## diff to guess: -0.0006396296771073243
'CS005' :  -2.1883144323479192e-07 , ## diff to guess: -0.0006400586103805497
'CS006' :  4.335870957322514e-07 , ## diff to guess: -0.0006455077940594544
'CS007' :  4.0029035817555713e-07 , ## diff to guess: -0.0005685558456045387
'CS011' :  -5.851406808561146e-07 , ## diff to guess: -0.00035917507646524065
'CS013' :  -1.8144559044239138e-06 , ## diff to guess: -0.0006445400351482457
'CS017' :  -8.440110176650205e-06 , ## diff to guess: -0.00013467955661883608
'CS024' :  2.321091042780375e-06 , ## diff to guess: -0.0006408086187604314
'CS401' :  -9.500543316619738e-07 , ## diff to guess: -0.0006368448183802344
'CS026' :  -9.236692525721069e-06 , ## diff to guess: -0.00015132554007380515
'CS030' :  -2.74506676586895e-06 , ## diff to guess: -0.0006384076602882526
'CS032' :  -1.5726260433002165e-06 , ## diff to guess: -0.0006377207891263
'CS103' :  -2.8521469674315262e-05 , ## diff to guess: -0.0006510364012791241
'CS201' :  -1.0485706843841852e-05 , ## diff to guess: -0.0006478774179408192
'CS301' :  -7.174925132755816e-07 , ## diff to guess: -0.0006444575141168867
'CS302' :  -5.350768609098982e-06 , ## diff to guess: -0.0006402524134154557
'CS501' :  -9.612859745165853e-06 , ## diff to guess: -0.0006396163428001889
'RS208' :  6.870105348295478e-06 , ## diff to guess: -0.0006860793854925155
'RS310' :  6.233575385637574e-06 , ## diff to guess: -0.0003229636323757411
'RS406' :  6.887866665262093e-06 , ## diff to guess: -0.0004646411593263095
'RS407' :  6.908340749404533e-06 , ## diff to guess: -0.0006523491234033179
'RS508' :  6.826086315069118e-06 , ## diff to guess: -0.0007179321627230024
'CS021' :  9.246539609106187e-07 , ## diff to guess: -0.0006385730183455096
'RS306' :  7.035523550442997e-06 , ## diff to guess: -0.0006119314903113133
      }
      '''



# fit 4
      '''
      self.event_index = 4

      self.source_locations = { 0 :[-29715.239081599037 , -7269.307480076134 , 5211.223464631507 , 1.2860940423173264  ],
                          10 :[  21025.47063296452 , -71811.62941023907 , 5318.008358576768 , 1.2337272673939923  ], #1.01E-9

      20 :[ -27403.49683718821 , -4778.270663263522 , 6108.05202126221 , 1.579733577674917 ],


      30 :[ -26344.281919671535 , -2298.7088219885613 , 4952.420136669922 , 1.8962371704442584 ], #7.50E-10

      40 :[ -21577.794596178315 , 3955.4677149612266 , 3841.3386034807895 , 2.0720892010514 ], #RMS=5.89E-10

                        }
      self.amplify = {'RS310':2.5,'RS208':5}

      self.reference_station = 'CS002'
      self.known_sources = [40]
      self.num_blocks = 10
      #self.guess_timing = self.source_locations[10][3]
      self.window_width = 5E-6
      self.bad_stations = ["RS205","RS210","RS509"]
      self.bad_stations += ["CS028" "RS409","RS106","RS307", "RS305","RS306"]


      self.fitter = "dt"
      self.known_polarizations = {40: 0}
      self.stations_to_exclude = {40:[],}
      self.antennas_to_exclude = {40:[],}
      self.bad_antennas = []

      self.initial_block = 5555#int(   self.guess_timing /((2**16)*(5.0E-9)) - 7  ) +20
      self.guess_timing = 1.8215241196665883
      self.guess_station_delays = {
"CS002": 0.0,
"CS001": 0.000498619229377385,
"CS003": 0.0002877132459652354,
"CS004": 0.0006400917083065923,
"CS005": 0.0006399134379755172,
"CS006": 0.0006459220651814772,
"CS007": 0.0005689012225424589,
"CS011": 0.0003588072708119148,
"CS013": 0.0006425089346193595,
"CS017": 0.00012625051981595935,
"CS024": 0.0006437935298281605,
"CS401": 0.0006360103108948856,
"CS026": 0.00014192018316762194,
"CS030": 0.0006349408220839892,
"CS032": 0.0006364262870317602,
"CS103": 0.0006223419508097876,
"CS201": 0.000637619651379404,
"CS301": 0.0006446658561348735,
"CS302": 0.0006364227903623172,
"CS501": 0.0006288592489473369,
"RS208": 0.0007152187208832598,
"RS310": 0.00033643093658509765,
"RS406": 0.0004656550310762097,
'RS407': 0.0006486183626598183,
"RS508": 0.0007138518330983672,
"CS021": 0.0006392262405910939,
"RS503": 0.0006500271085873993,

#"RS306": 0.0006237493740089826,
#"RS305": 0.0006332468040064628,
#"RS106": 0.0006753090947117151,
#"RS307": 0.00041124871678974146,
#"RS409": 0.0006183857783413747,
#"CS028": 0.0006305509912828762,
}



      self.fitted_delays ={
      'CS001' :  2.2312358071102865e-06 , ## diff to guess: -0.0004963879935702747
'CS003' :  1.4061071179662296e-06 , ## diff to guess: -0.0002863071388472692
'CS004' :  4.329250742557101e-07 , ## diff to guess: -0.0006396587832323366
'CS005' :  -2.200688304340191e-07 , ## diff to guess: -0.0006401335068059511
'CS006' :  4.307738307064985e-07 , ## diff to guess: -0.0006454912913507708
'CS007' :  3.991894298956642e-07 , ## diff to guess: -0.0005685020331125632
'CS011' :  -5.89765646283992e-07 , ## diff to guess: -0.00035939703645819883
'CS013' :  -1.8111842440378735e-06 , ## diff to guess: -0.0006443201188633974
'CS017' :  -8.447992988846486e-06 , ## diff to guess: -0.00013469851280480582
'CS024' :  2.31708377444351e-06 , ## diff to guess: -0.0006414764460537171
'CS401' :  -9.321372192780832e-07 , ## diff to guess: -0.0006369424481141637
'CS026' :  -9.251328213152332e-06 , ## diff to guess: -0.00015117151138077428
'CS030' :  -2.7345170110278037e-06 , ## diff to guess: -0.000637675339095017
'CS032' :  -1.5597794890543345e-06 , ## diff to guess: -0.0006379860665208145
'CS103' :  -2.855217641353192e-05 , ## diff to guess: -0.0006508941272233195
'CS201' :  -1.0500869889141093e-05 , ## diff to guess: -0.0006481205212685451
'CS301' :  -7.135759193481706e-07 , ## diff to guess: -0.0006453794320542217
'CS302' :  -5.321590394339228e-06 , ## diff to guess: -0.0006417443807566564
'CS501' :  -9.609877745178072e-06 , ## diff to guess: -0.0006384691266925149
'RS208' :  1.035051232658336e-05 , ## diff to guess: -0.0007048682085566764
'RS310' :  7.981876594917844e-06 , ## diff to guess: -0.0003284490599901798
'RS406' :  1.0543278721701476e-05 , ## diff to guess: -0.0004551117523545082
'RS407' :  0.0006486183626598183 , ## diff to guess: 0.0
'RS508' :  6.979397963501373e-06 , ## diff to guess: -0.0007068724351348658
'CS021' :  9.325804483061111e-07 , ## diff to guess: -0.0006382936601427878
'RS503' :  1.0281525831444524e-05 , ## diff to guess: -0.0006397455827559549


      }
      '''

      '''
      self.event_index = 5

      #sources = np.load("working_sources.npy").all()

      #best so far:
      #sources[50] = [ -20511.32475222903 , 4514.316571571672 , 4839.402802786423 , 2.1190570377836373  ]

      #x = sources[50][0]
      #y = sources[50][1]
      #z = sources[50][2]
      #t = sources[50][3]

      self.source_locations = {
      0 :[-29715.239081599037 , -7269.307480076134 , 5211.223464631507 , 1.2860940423173264  ], #7.25E-10

      10 :[  21025.47063296452 , -71811.62941023907 , 5318.008358576768 , 1.2337272673939923  ], #1.01E-9

      20 :[ -27403.49683718821 , -4778.270663263522 , 6108.05202126221 , 1.579733577674917 ], #RMS=1.01E-09


      30 :[ -26344.281919671535 , -2298.7088219885613 , 4952.420136669922 , 1.8962371704442584 ], #7.50E-10

      40 :[ -21577.794596178315 , 3955.4677149612266 , 3841.3386034807895 , 2.0720892010514 ], #RMS=5.89E-10

      50 :[ -20511.32475222903 , 4514.316571571672 , 4839.402802786423 , 2.1190570377836373  ] #RMS=5.89E-10
      #50 :[ x,y,z,t ], #RMS=5.89E-10

                        }
      self.amplify = {}#{'RS310':2.5,'RS208':5}

      self.reference_station = 'CS002'
      self.known_sources = [50]
      self.num_blocks = 10
      #self.guess_timing = self.source_locations[10][3]
      self.window_width = 5E-6
      self.bad_stations = ["RS205","RS210","RS509"]
      self.bad_stations += ["CS028" "RS208","RS503","RS409","RS306"]

      self.fitter = "dt"
      self.known_polarizations = {50: 0}
      self.stations_to_exclude = {50:[],}
      self.antennas_to_exclude = {50:[],}
      self.bad_antennas = []

      self.initial_block = 5700#int(   self.guess_timing /((2**16)*(5.0E-9)) - 7  ) +20

      self.guess_timing = 1.8684895548097162
      self.guess_station_delays = {
"CS002": 0.0,
"CS001": 0.0004986301103783741,
"CS003": 0.0002877294830184929,
"CS004": 0.0006401077633605452,
"CS005": 0.0006399257600362223,
"CS006": 0.0006459178213868282,
"CS007": 0.0005688984343518916,
"CS011": 0.00035869441201516234,
"CS013": 0.0006424062524279432,
"CS017": 0.00012613949836037496,
"CS024": 0.0006438675762968949,
"CS401": 0.0006360582854472163,
"CS026": 0.0001418730720110905,
"CS030": 0.0006348986163692882,
"CS032": 0.0006364943977381684,
"CS103": 0.0006223100691316012,
"CS201": 0.0006375771713230426,
"CS301": 0.0006447834535786563,
"CS302": 0.0006365923274704473,
"CS501": 0.0006287403781712256,
"CS021": 0.0006392086523373516,
"RS310": 0.00034131344237698985,
"RS406": 0.00046148390941236675,
"RS407": 0.000647626481100265,
"RS508": 0.0007127826384326746,

"RS305": 0.0006332468040064628,
"RS106": 0.0006753090947117151,
"RS307": 0.00041124871678974146,

#"RS306": 0.0006237493740089826,
#"RS409": 0.000629307528860019,
#"RS503": 0.0006464229689051432,

#"RS208": 0.0014155621858778973,
#"CS028": 0.0006304052248204202,
}

      self.fitted_delays ={

'CS001' :  2.2265273008406896e-06 , ## diff to guess: -0.0004964035830775334
'CS003' :  1.4054982556073422e-06 , ## diff to guess: -0.00028632398476288555
'CS004' :  4.306349222548413e-07 , ## diff to guess: -0.0006396771284382904
'CS005' :  -2.1867363105145257e-07 , ## diff to guess: -0.0006401444336672737
'CS006' :  4.3570106687913716e-07 , ## diff to guess: -0.0006454821203199491
'CS007' :  4.020252293277255e-07 , ## diff to guess: -0.0005684964091225639
'CS011' :  -5.832227596330182e-07 , ## diff to guess: -0.00035927763477479536
'CS013' :  -1.8127621203897654e-06 , ## diff to guess: -0.000644219014548333
'CS017' :  -8.43613580535089e-06 , ## diff to guess: -0.00013457563416572585
'CS024' :  2.3199660062189317e-06 , ## diff to guess: -0.000641547610290676
'CS401' :  -9.559465253735779e-07 , ## diff to guess: -0.0006370142319725899
'CS026' :  -9.229618688118712e-06 , ## diff to guess: -0.00015110269069920922
'CS030' :  -2.7422835854947956e-06 , ## diff to guess: -0.0006376408999547831
'CS032' :  -1.577923593486281e-06 , ## diff to guess: -0.0006380723213316547
'CS103' :  -2.8509948360809985e-05 , ## diff to guess: -0.0006508200174924111
'CS201' :  -1.0481953213339954e-05 , ## diff to guess: -0.0006480591245363826
'CS301' :  -7.240667123385146e-07 , ## diff to guess: -0.0006455075202909948
'CS302' :  -5.368121176583192e-06 , ## diff to guess: -0.0006419604486470305
'CS501' :  -9.605294344657445e-06 , ## diff to guess: -0.0006383456725158831
'CS021' :  9.240608011711369e-07 , ## diff to guess: -0.0006382845915361805
'RS310' :  6.22952329250027e-06 , ## diff to guess: -0.0003350839190844896
'RS406' :  6.894561187240647e-06 , ## diff to guess: -0.0004545893482251261
'RS407' :  6.94118233475604e-06 , ## diff to guess: -0.000640685298765509
'RS508' :  6.904302014859803e-06 , ## diff to guess: -0.0007058783364178148
'RS305' :  6.851342293796138e-06 , ## diff to guess: -0.0006263954617126667
'RS106' :  7.021104530447694e-06 , ## diff to guess: -0.0006682879901812673
'RS307' :  6.687958264364249e-06 , ## diff to guess: -0.0004045607585253772


      }

      '''

      #fitting all 5:
      self.event_index = 5

      sources = np.load("working_sources.npy").all()

      #best so far:
      best_sources = {
0 :[ -29598.157186912867 , -7170.573819107196 , 4794.306340107428 , 1.2860947190638874 ],
10 :[ -29498.198708003412 , -6928.275494832549 , 5224.993880674035 , 1.2816615359591734 ],
20 :[ -27263.221602722693 , -4763.716825983669 , 6398.653422229301 , 1.5797338215915417 ],
30 :[ -26357.737134051345 , -2289.820771515302 , 4850.7003459848775 , 1.8962371910717857 ],
40 :[ -21369.42147152542 , 3946.640377139842 , 4400.305348061103 , 2.0720895325709052 ],
50 :[ -20633.999719844836 , 4504.467050719536 , 4733.973719270672 , 2.1190567339651274 ],

#| 0  | 1.40E-09 |
#| 10 | 1.80E-09 |
#| 20 | 1.82E-09 |
#| 30 | 1.36E-09 |
#| 40 | 6.80E-10 |
#| 50 | 1.21E-09 |
      }
      #sources = best_sources


      self.source_locations = {
      #0 :[-29715.239081599037 , -7269.307480076134 , 5211.223464631507 , 1.2860940423173264  ], #7.25E-10
      0 :sources[0], #7.25E-10

      #10 :[  21025.47063296452 , -71811.62941023907 , 5318.008358576768 , 1.2337272673939923  ], #1.01E-9
      10 :sources[10], #1.01E-9


      #20 :[ -27403.49683718821 , -4778.270663263522 , 6108.05202126221 , 1.579733577674917 ], #RMS=1.01E-09
      20 :sources[20], #RMS=1.01E-09


      #30 :[ -26344.281919671535 , -2298.7088219885613 , 4952.420136669922 , 1.8962371704442584 ], #7.50E-10
      30 :sources[30], #RMS=5.89E-10


      #40 :[ -21577.794596178315 , 3955.4677149612266 , 3841.3386034807895 , 2.0720892010514 ], #RMS=5.89E-10
      40 :sources[40], #RMS=5.89E-10

      #50 :[ -20511.32475222903 , 4514.316571571672 , 4839.402802786423 , 2.1190570377836373  ] #RMS=5.89E-10
      50 :sources[50], #RMS=5.89E-10

                        }
      self.amplify = {}#{'RS310':2.5,'RS208':5}

      self.reference_station = 'CS002'
      self.known_sources = [0,10,20,30,40,50]
      self.num_blocks = 10
      #self.guess_timing = self.source_locations[10][3]
      self.window_width = 5E-6
      self.bad_stations = ["RS205","RS210","RS509","CS028"]
      self.bad_stations += [ "RS208","RS503","RS409","RS306",'RS307','RS310','RS406']

      self.fitter = "dt"
      self.known_polarizations = {0: 0, 10: 0, 20: 0, 30: 0, 40: 0, 50: 0}
      self.stations_to_exclude = {0:[],10: [],20:[],30:[],40:[],50:[],}
      self.antennas_to_exclude = {0:[],10: [],20:[],30:[],40:[],50:[],}
      self.bad_antennas = []

      self.initial_block = 5700#int(   self.guess_timing /((2**16)*(5.0E-9)) - 7  ) +20

      self.guess_timing = 1.8684895548097162
      self.guess_station_delays = {
"CS002": 0.0,
"CS001": 0.0004986301103783741,
"CS003": 0.0002877294830184929,
"CS005": 0.0006399257600362223,
"CS006": 0.0006459178213868282,
"CS007": 0.0005688984343518916,

"CS011": 0.00035869441201516234,

"CS013": 0.0006424062524279432,
"CS017": 0.00012613949836037496,
"CS024": 0.0006438675762968949,
"CS401": 0.0006360582854472163,

"CS026": 0.0001418730720110905,
"CS030": 0.0006348986163692882,
"CS032": 0.0006364943977381684,

"CS103": 0.0006223100691316012,
"CS201": 0.0006375771713230426,
"CS302": 0.0006365923274704473,
"CS501": 0.0006287403781712256,

###"CS004": 0.0006401077633605452,
###"CS021": 0.0006392086523373516,


"CS301": 0.0006447834535786563,
"RS305": 0.0006332468040064628,
"RS106": 0.0006753090947117151,
"RS407": 0.000647626481100265,
"RS508": 0.0007127826384326746,


##"RS307": 0.00041124871678974146,
##"RS306": 0.0006237493740089826,
##"RS310": 0.00034131344237698985,
##"RS406": 0.00046148390941236675,

#"RS208": 0.0014155621858778973,
#"RS503": 0.0006464229689051432,
#"RS409": 0.000629307528860019,
#"CS028": 0.0006304052248204202,
}

      self.fitted_delays ={

'CS001' :  2.2265273008406896e-06 , ## diff to guess: -0.0004964035830775334
'CS003' :  1.4054982556073422e-06 , ## diff to guess: -0.00028632398476288555
'CS004' :  4.306349222548413e-07 , ## diff to guess: -0.0006396771284382904
'CS005' :  -2.1867363105145257e-07 , ## diff to guess: -0.0006401444336672737
'CS006' :  4.3570106687913716e-07 , ## diff to guess: -0.0006454821203199491
'CS007' :  4.020252293277255e-07 , ## diff to guess: -0.0005684964091225639
'CS011' :  -5.832227596330182e-07 , ## diff to guess: -0.00035927763477479536
'CS013' :  -1.8127621203897654e-06 , ## diff to guess: -0.000644219014548333
'CS017' :  -8.43613580535089e-06 , ## diff to guess: -0.00013457563416572585
'CS024' :  2.3199660062189317e-06 , ## diff to guess: -0.000641547610290676
'CS401' :  -9.559465253735779e-07 , ## diff to guess: -0.0006370142319725899
'CS026' :  -9.229618688118712e-06 , ## diff to guess: -0.00015110269069920922
'CS030' :  -2.7422835854947956e-06 , ## diff to guess: -0.0006376408999547831
'CS032' :  -1.577923593486281e-06 , ## diff to guess: -0.0006380723213316547
'CS103' :  -2.8509948360809985e-05 , ## diff to guess: -0.0006508200174924111
'CS201' :  -1.0481953213339954e-05 , ## diff to guess: -0.0006480591245363826
'CS301' :  -7.240667123385146e-07 , ## diff to guess: -0.0006455075202909948
'CS302' :  -5.368121176583192e-06 , ## diff to guess: -0.0006419604486470305
'CS501' :  -9.605294344657445e-06 , ## diff to guess: -0.0006383456725158831
'CS021' :  9.240608011711369e-07 , ## diff to guess: -0.0006382845915361805
'RS310' :  6.22952329250027e-06 , ## diff to guess: -0.0003350839190844896
'RS406' :  6.894561187240647e-06 , ## diff to guess: -0.0004545893482251261
'RS407' :  6.94118233475604e-06 , ## diff to guess: -0.000640685298765509
'RS508' :  6.904302014859803e-06 , ## diff to guess: -0.0007058783364178148
'RS305' :  6.851342293796138e-06 , ## diff to guess: -0.0006263954617126667
'RS106' :  7.021104530447694e-06 , ## diff to guess: -0.0006682879901812673
'RS307' :  6.687958264364249e-06 , ## diff to guess: -0.0004045607585253772


      }


      '''BAAAAAAD
      self.event_index = 3

      self.source_locations = {#{ 0 :[-29715.239081599037 , -7269.307480076134 , 5211.223464631507 , 1.2860940423173264  ],
                                #10 :[  21025.47063296452 , -71811.62941023907 , 5318.008358576768 , 1.2337272673939923  ],

#20 :[ -27403.49683718821 , -4778.270663263522 , 6108.05202126221 , 1.579733577674917 ],

30 :[ -3467344.649129365 , 25470.685757845687 , -4984769.834219104 , 1.2722116853383583   ],
                              }

      self.known_sources = [30]
      self.num_blocks = 10
      self.guess_timing = 1.0418322166081537
      self.window_width = 5E-6
      self.initial_block = int(   self.guess_timing /((2**16)*(5.0E-9)) - 7  ) +20
      self.bad_stations = ["RS205","RS210","RS509"] #["RS205","RS210", "CS028", "RS106", "RS306" ]

      #self.bad_stations += ["CS028","RS106","RS307", "RS409","RS305"]

      #self.bad_stations += ["CS021","RS306"]


      self.fitter = "dt"
      #self.initial_block = 4050
      self.known_polarizations = {30: 0}
      self.stations_to_exclude = {30:[],}
      self.antennas_to_exclude = {30:[],}
      self.bad_antennas = []
      self.guess_station_delays = {
"CS001": 0.0004981415327721137,
"CS002": 0.0,
#"CS003": 0.00028793319192151084,
#"CS004": 0.0006400547838578976,
#"CS005": 0.0006398282553102885,
#"CS006": 0.0006459213699213206,
#"CS007": 0.0005689965099997436,
#"CS011": 0.0003585930197216723,
#"CS013": 0.0006428591665600568,
#"CS017": 0.00012625295226686398,
#"CS021": 0.0006396241044730713,
#"CS024": 0.0006428413419705143,
#"CS026": 0.00014211827825300072,
#"CS028": 0.0006319785308206503,
"CS030": 0.0006359787867076814,
"CS032": 0.0006360810387252871,
#"CS103": 0.0006224688693495739,
#"CS201": 0.0006372639888436743,
#"CS301": 0.0006433765293743212,
#"CS302": 0.0006344033369426905,
"CS401": 0.0006359152201693696,
"CS501": 0.0006304055590827438,
"RS106": 0.0006708246923455581,
"RS208": 0.0006830883290416254,
"RS306": 0.0006180907022141819,
"RS305": 0.0006302195235609956,
"RS307": 0.0003828742664210795,
"RS310": 0.00027425386384413654,
"RS406": 0.0004752462883734277,
"RS407": 0.000663513977346163,
"RS409": 0.0006033993635760048,
"RS503": 0.0006508126691596839,
"RS508": 0.000729138979312276,
}
      '''

#old 4 ---HUGE TIME SUCKER!
      '''
      self.event_index = 3

      self.source_locations = { 0 :[-29715.239081599037 , -7269.307480076134 , 5211.223464631507 , 1.2860940423173264  ],
                          10 :[  21025.47063296452 , -71811.62941023907 , 5318.008358576768 , 1.2337272673939923  ],

      20 :[ -27403.49683718821 , -4778.270663263522 , 6108.05202126221 , 1.579733577674917 ],



#30 :[ -26907.62090306227 , -8044.299065144755 , 5067.212663174355 , 1.2923751730352862 ],

#30 :[ -29493.709605565797 , -7686.74631132304 , 5598.457032095444 , 1.2923692835726501 ],
30 :[ -39112.855131674965 , -15914.749954391275 , 4523.028831263256 , 1.2923311393325825 ],

                        }
      self.reference_station = 'CS001'
      self.known_sources = [30]
      self.num_blocks = 10
      #self.guess_timing = self.source_locations[10][3]
      self.window_width = 5E-6
      self.bad_stations = ["RS205","RS210","RS509"] #["RS205","RS210", "CS028", "RS106", "RS306" ]

      #self.bad_stations += ["CS028","RS106","RS307", "RS409","RS305"]

      #self.bad_stations += ["CS021","RS306"]

      self.fitter = "dt"
      #self.initial_block = 4050
      self.known_polarizations = {30: 0}
      self.stations_to_exclude = {30:[],}
      self.antennas_to_exclude = {30:[],}
      self.bad_antennas = []

      self.guess_timing = 1.0998591158605187
      self.initial_block = int(   self.guess_timing /((2**16)*(5.0E-9)) - 7  ) +20
      self.guess_station_delays = {
"CS001": 0.0004981373619171189,
#"CS002": 0.0,


#"CS003": 0.00028792936670159224,


#"CS004": 0.0006400524984509228,
#"CS005": 0.0006398209321066894,
#"CS006": 0.0006459165302653113,
#"CS007": 0.000568972870771391,
#"CS011": 0.0003585331996079209,


"CS013": 0.0006428612664809607,

#"CS017": 0.00012625394640230461,


"CS021": 0.0006397831521061351,

#"CS024": 0.0006428426126784976,

#"CS026": 0.00014209808683224312,

"CS030": 0.0006359939451237593,
"CS032": 0.0006360756732305719,
#"CS103": 0.0006224690317538861,

#"CS201": 0.0006372651225938791,
"CS301": 0.0006433931216025792,
#"CS302": 0.0006343963008722975,

"CS401": 0.0006359159813777993,

"CS501": 0.0006304257583136983,

#RS106": 0.0006709978388688994,
"RS208": 0.0006871153812404438,
"RS306": 0.0006180729137190606,

"RS305": 0.0006301995144028874,
"RS307": 0.00038541138513375497,
#"RS310": 0.00029934039351595045,
"RS406": 0.00047713512465947356,
"RS407": 0.0006665319039407914,
#"RS409": 0.001251468729511427,
"RS503": 0.0006509514676299567,
"RS508": 0.0007325337037747004,



#"CS028": 0.0006319986912166696,

#"RS509": 0.00025519469083676397,
#"RS210": 0.00045996009448966846,
#"RS205": 0.0006511348995213441,

}

      '''







      """
      #Hopefully:
      self.event_index = 1

      self.source_locations = {#{ 0 :[-29715.239081599037 , -7269.307480076134 , 5211.223464631507 , 1.2860940423173264  ],

                                10 :[  21025.47063296452 , -71811.62941023907 , 5318.008358576768 , 1.2337272673939923  ],
                                #10 :[  0.0,0.0,0.0, 0.9833381159490392  ],

                              }
      self.known_sources = [10]
      self.initial_block = 3005
      self.num_blocks = 20
      #self.guess_timing = self.source_locations[10][3]
      self.window_width = 5E-6
      #self.initial_block = int(   self.guess_timing /((2**16)*(5.0E-9)) - 7  ) +20
      self.bad_stations = ["RS205","RS210","RS509"] #["RS205","RS210", "CS028", "RS106", "RS306" ]
      self.fitter = "dt"
      self.bad_antennas = []


      self.guess_timing = 1.2337272673939923
      self.guess_station_delays = {
"CS001": 0.000497671950849656,
"CS002": 0.0,
"CS003": 0.0002885168753886255,
"CS004": 0.000640239412619066,
"CS006": 0.0006453094787536972,
"CS005": 0.0006394929068217547,
"CS011": 0.0003571168107766996,
"CS007": 0.000568794254296447,
"CS013": 0.0006445114265227935,
"CS017": 0.00012449137765657117,
"CS021": 0.0006423089152034736,
"CS024": 0.0006396317765625121,
"CS026": 0.00013879463752558563,
"RS409": 0.0007246906339628522,
"CS032": 0.000638126877646448,
"CS030": 0.0006403239798727376,
"CS103": 0.0006152275189064083,
"CS201": 0.0006329075046658266,
"CS301": 0.0006412235249849942,
"CS302": 0.0006363888378481564,
"CS401": 0.0006396921207705297,
"CS501": 0.0006345790240837776,
"RS208": 0.0005623660444175058,
"RS310": 0.00034246976731963576,
"RS307": 0.0003998902241401593,
"RS406": 0.0005275375630985968,
"RS407": 0.0007155674040247407,
"RS503": 0.0006638677279504735,
"RS508": 0.0007611934076717941,
"CS028": 0.0006335335275635678,
"RS305": 0.0006534894123363388,
"RS306": 0.0006478409154283549,
"RS106": 0.0006262619193254659,
}
      """

      '''
      self.guess_station_delays = {

"CS001": 0.0004977168615618052,
"CS002": 0.0,
"CS003": 0.00028846012223100764,
"CS004": 0.0006402745606944051,
"CS006": 0.0006453041105064061,
"CS005": 0.0006394829595681783,
"CS011": 0.00035713974425415003,
"CS007": 0.0005687816294581611,
"CS013": 0.0006445371109533759,
"CS017": 0.00012445106653779484,
"CS021": 0.0006421334157688222,
"CS024": 0.0006395214896701158,
"CS026": 0.0001388131789516468,
"RS409": 0.0006001034010293371,
"CS032": 0.0006382487856616861,
"CS030": 0.0006403269036858181,
"CS103": 0.0006151717197035944,
"CS201": 0.0006328852041558325,
"CS301": 0.0006412547668685188,
"CS302": 0.0006362803036841669,
"CS401": 0.0006395593368024866,
"CS501": 0.0006346085289055856,
"RS208": 0.0005623555532463518,
"RS310": 0.00034222537415481914,
"RS307": 0.0003999567197464028,
"RS406": 0.0005275506159147581,
"RS407": 0.0007155290450012276,
"RS503": 0.0006638995643783008,
"RS508": 0.0007364452067239057,
"CS028": 9.615071884239157e-06,
"RS305": -3.5090890297961863e-06,
"RS306": -9.222968262889708e-06,
"RS106": 2.1011700725992455e-06
}
      '''
      """
      self.fitted_delays = {
'CS001' :  2.22619624282272e-06 , ## diff to guess: -0.0004954906653189825
'CS003' :  1.406803258122178e-06 , ## diff to guess: -0.00028705331897288544
'CS004' :  4.3324323029864915e-07 , ## diff to guess: -0.0006398413174641065
'CS006' :  4.3448789962787955e-07 , ## diff to guess: -0.0006448696226067782
'CS005' :  -2.1859587067515092e-07 , ## diff to guess: -0.0006397015554388534
'CS011' :  0.00035713974425415003 , ## diff to guess: 0.0
'CS007' :  4.029247334024903e-07 , ## diff to guess: -0.0005683787047247586
'CS013' :  -1.8133608330550927e-06 , ## diff to guess: -0.000646350471786431
'CS017' :  -8.431899033949215e-06 , ## diff to guess: -0.00013288296557174405
'CS021' :  9.233229051012918e-07 , ## diff to guess: -0.0006412100928637209
'CS024' :  2.3211752713829488e-06 , ## diff to guess: -0.0006372003143987328
'CS026' :  -9.225277027381619e-06 , ## diff to guess: -0.00014803845597902843
'RS409' :  -0.00011762948658478089 , ## diff to guess: -0.000717732887614118
'CS032' :  -1.5782531094023483e-06 , ## diff to guess: -0.0006398270387710885
'CS030' :  -2.7434354871145883e-06 , ## diff to guess: -0.0006430703391729327
'CS103' :  -2.850447538576822e-05 , ## diff to guess: -0.0006436761950893627
'CS201' :  -1.0476632163748411e-05 , ## diff to guess: -0.0006433618363195808
'CS301' :  -7.216293096330698e-07 , ## diff to guess: -0.0006419763961781519
'CS302' :  -5.365387762139159e-06 , ## diff to guess: -0.0006416456914463061
'CS401' :  -9.583717271606189e-07 , ## diff to guess: -0.0006405177085296471
'CS501' :  -9.60884149962029e-06 , ## diff to guess: -0.000644217370405206
'RS208' :  6.898973386710317e-06 , ## diff to guess: -0.0005554565798596415
'RS310' :  6.801265682825424e-06 , ## diff to guess: -0.0003354241084719937
'RS307' :  6.842073939323096e-06 , ## diff to guess: -0.0003931146458070797
'RS406' :  6.944076839852676e-06 , ## diff to guess: -0.0005206065390749054
'RS407' :  7.049714064021377e-06 , ## diff to guess: -0.0007084793309372062
'RS503' :  6.950310806817508e-06 , ## diff to guess: -0.0006569492535714834
'RS508' :  -1.748086762154502e-05 , ## diff to guess: -0.0007539260743454507
'CS028' :  -0.000633874688223761 , ## diff to guess: -0.0006434897601080001
'RS305' :  -3.5090890297961863e-06 , ## diff to guess: 0.0
'RS306' :  -9.222968262889708e-06 , ## diff to guess: 0.0
'RS106' :  -0.0006168396959024629 , ## diff to guess: -0.0006189408659750622

      }

      """


      """ no

      self.event_index = 0
      self.initial_block = 3200
      self.guess_source_location = 1.051832192116396

      self.guess_station_delays = {
"CS002": 0.0,
"CS001": 0.0004981436304433717,
"CS003": 0.000287907394550222,
"CS004": 0.0006400520329786803,
"CS005": 0.0006398073393083319,
"CS006": 0.0006459365015009504,
"CS007": 0.0005689781604398453,
"CS011": 0.0003585344637252162,
"CS013": 0.0006428662520274657,
"CS017": 0.00012625809539523435,
"CS021": 0.0006396410533969762,
"CS024": 0.0006428526742151864,
"CS026": 0.00014205496005327382,
"CS028": 0.0006321497203715461,
"CS030": 0.0006359907587458236,
"CS032": 0.0006360914907359624,
"CS103": 0.0006224709502762297,
"CS201": 0.0006372937269828215,
"CS301": 0.0006433942629825436,
"CS302": 0.0006344193462861243,
"CS501": 0.0006304704477730275,
#{}"RS208": 0.0006828997912574078,
"RS208": 0.0005626399106722361,
"RS305": 0.0006302264462563353,
"RS106": 0.0006707231706545495,
"RS306": 0.0006180689952533922,
"RS307": 0.00038276062147676854,
"RS310": 0.00027221558517854854,
"RS406": 0.0004751369531996762,
"RS407": 0.0006632128036462113,
"RS409": 0.0007386097649556398,
"RS503": 0.0006508096169006567,
"RS508": 0.000728741983679571,
"CS401": 0.0006359338183978824,
}
      """


      ''' no
      self.pulse_time = 0.9855683
      self.event_index = 0
      self.initial_block = 3000

    #left is subtract, right is add!
      self.guess_station_delays = {
"CS002": 0.0,
"RS208": 0.0005624974756038296,
#{}"RS210": 0.0,
"RS305": 0.0006534438412713203,
"CS001": 0.0004976874681103538,
"CS003": 0.0002885271382126109,
"CS004": 0.0006402827548871477,
"CS005": 0.0006394572463612551,
"CS006": 0.0006452761763797015,
"CS007": 0.0005688089768573684,
"CS011": 0.00023266888712555653,
"CS013": 0.0006445103363752396,
"CS017": 0.0001244789469280163,
"CS021": 0.0006422731856784422,
"CS024": 0.000639535175866488,
"CS026": 0.0001388116756988588,
"CS028": 0.0006335026142480289,
"CS030": 0.0006403065597586122,
"CS032": 0.0006381226541571968,
"CS103": 0.00061520424623884,
"CS201": 0.0006329816032129875,
"CS301": 0.0006412170221553599,
"CS302": 0.0006362637867169559,
"CS501": 0.000634574484676679,
"RS106": 0.0006261774599253449,
"RS306": 0.0006477875402742659,
"RS307": 0.0003998290191406793,
"RS310": 0.0003422287144797648,
"RS406": 0.0005275611665420709,
"RS407": 0.0007155451155745716,
"RS409": 0.0007245813337243121,
"RS503": 0.0006638524493833692,
"RS508": 0.0007612062741507835,
"CS401": 0.0006397108944753427,
}
      '''

      '''
      self.pulse_time = ?
      self.event_index = 0
      self.initial_block = ?
      self.guess_station_delays = {

"CS002": 0.0,

"RS208":  7.97951240511e-06,  ##??
'RS210': 0.0, ##??
'RS305' :  7.1934989871e-06 , ## diff to guess: 1.37699440122e-09 ## station has issues
'CS001' :  2.24401172494e-06 , ## diff to guess: -1.97549250145e-12
'CS003' :  1.4070479021e-06 , ## diff to guess: -2.43902860006e-11
'CS004' :  4.40075444977e-07 , ## diff to guess: -2.42217738996e-11
'CS005' :  -2.17678756484e-07 , ## diff to guess: -2.21583592931e-11
'CS006' :  4.30647454293e-07 , ## diff to guess: -1.65542771957e-11
'CS007' :  3.99377465507e-07 , ## diff to guess: -2.02129216007e-11
'CS011' :  -5.8955385854e-07 , ## diff to guess: -1.23462674702e-12
'CS013' :  -1.81293364466e-06 , ## diff to guess: -2.14074126082e-11
'CS017' :  -8.4551582793e-06 , ## diff to guess: 4.31470974773e-11
'CS021' :  9.23663075135e-07 , ## diff to guess: 0.0
'CS024' :  2.33045304324e-06 , ## diff to guess: 8.82976926023e-12
'CS026' :  -10.26723147045e-06 , ## diff to guess: -9.26723147045e-06
'CS028' :  -11.06723147045e-06 ,
'CS030' :  -2.73965173619e-06 , ## diff to guess: 2.41776414432e-11
'CS032' :  -1.54223879178e-06 , ## diff to guess: -2.35580980099e-06
'CS103' :  -2.95878989548e-05 , ## diff to guess: 7.47105624697e-10
'CS201' :  -1.0510320435e-05 , ## diff to guess: 1.70364032269e-10
'CS301' :  -6.87236667019e-07 , ## diff to guess: -2.36495962731e-11
'CS302' :  -3.26832572532e-06 , ## diff to guess: 3.69871327386e-10
'CS501' :  -9.63031916796e-06 , ## diff to guess: -1.77630731779e-11
'RS106' :  -1.78633242596e-06 , ## diff to guess: 1.575478568e-08
'RS305' :  13.41317947913e-06 , ## diff to guess: 1.6935786672e-08
'RS306' :  14.41317947913e-06 , ## diff to guess: 1.6935786672e-08
'RS307' :  -3.80951637749e-06 , ## diff to guess: 5.67451737617e-08
'RS310' :  24.96312229684e-06 , ## diff to guess: 4.82651956563e-07
'RS406' :  11.96541956339e-06 , ## diff to guess: 8.9825482633e-09
'RS407' :  8.83033534647e-06 , ## diff to guess: 3.5607628373e-09
'RS409' :  22.4346353712e-06 , ## diff to guess: 1.55561380515e-07
'RS503' :  6.9238247372e-06 , ## diff to guess: 2.51105167164e-10
'RS508' :  0.36331650134e-06 , ## diff to guess: 2.40127126525e-09
        }
      '''



      '''no...
      self.initial_block = 2730
      self.source_locations = {0:[ 0.0, 0.0 , 0.0 , 0.8990699909913916  ]}
      self.fitter = "dt"
      self.guess_source_location = 0.8990699909913916
      self.event_index = 0

      self.guess_station_delays = {
"CS001": 0.0004977303459449709,
"CS002": 0.0,
"CS003": 0.00028852104935846195,
"CS004": 0.0006402439600836931,
"CS005": 0.0006394278803335606,
"CS006": 0.0006452923791751663,
"CS007": 0.000568788751851836,
"CS011": 0.0003571079301086098,
"CS013": 0.000644517024263953,
"CS017": 0.00012446334648640836,
"CS021": 0.0006423113371174763,
"CS024": 0.0006395461614134307,
"CS026": 0.00013894285903032222,
"CS028": 0.0006334390512655684,
"CS030": 0.0006403463147338093,
"CS032": 0.0006381537918004645,
"CS103": 0.0006151671576746176,
"CS201": 0.0006328826574848472,
"CS301": 0.0006412427291620206,
"CS302": 0.0006363583388199646,
"CS401": 0.0006397750246482925,
"CS501": 0.0006345756493834807,
"RS106": 0.0006259192505855012,
#{}"RS205": 0.0006248346748171653,
"RS208": 0.0005626944299421675,
#{}"RS210": 0.0005856177079424027,
"RS306": 0.0006481363692921645,
"RS305": 0.000653711840512863,
"RS307": 0.00040046910288854,
"RS310": 0.00034373819146590813,
"RS406": 0.0005276955540454776,
"RS407": 0.0007155004539644672,
"RS409": 0.0007254104349571055,
"RS503": 0.0006638695759079272,
"RS508": 0.0007607752629982411,
#{}"RS509": 0.00031204973433471376,
}

      '''
      """ nooooo...
      self.initial_block = 2730
      #self.source_locations = {0:[20820.25538400243 , -67800.50180603338 , 16.972221609193596 , 1.149472776318406   ]}
      self.source_locations = {0 :[ 20656.086311472034 , -67251.4806958012 , -0.0009538279762806917 , 1.149474688291205 ]}

      self.fitter = "dt"
      self.guess_source_location = 0.8935284399533284
      self.event_index = 1
      self.guess_station_delays = {
#"CS001": 0.000497651540194046,
"CS002": 0.0,
#"CS003": 0.0002885238389424702
"CS004": 0.0006402899882213277,
"CS005": 0.0006393937079282108,
"CS006": 0.0006452730827739117,
#"CS007": 0.0005687821321672577,
#"CS011": 0.00035727498144293087,
"CS013": 0.0006445047000568537,
"CS017": 0.00012442833146796809,
"CS021": 0.0006422856229509025,
"CS024": 0.0006395169594273793,
#"CS026": 0.0001387288026121759,
"CS028": 0.0006334057920436363,
"CS030": 0.0006402980088003338,
"CS032": 0.000638128369407496,
"CS103": 0.000615125121204313,
#"CS201": 0.0006328446504333412,
"CS301": 0.0006412174725068089,
"CS302": 0.0006363433805617769,
#"CS401": 0.0006396928816095881,
"CS501": 0.000634538848480489,
"RS407": 0.0007154912679908188,
"RS503": 0.0006638522741299169,
"RS508": 0.0007606503469186498,

"RS106": 0.0006258367489131185,
#"RS305": 0.000653732214977645,
"RS310": 0.0003440852698257384}
#"RS409": 0.0007256573139731137,

#{}"RS205": 0.0006249828532188252,
#{}"RS210": 0.0006367307752548276,
#{}"RS509": 0.0003119783727901513,

#"RS208": 0.0005627620879405935,
#"RS306": 0.0006481776557465309,

#"RS307": 0.0004006079786274487}

#{}"RS406": 0.0005276307017697058
}
      """
      ''' not really
      self.initial_block = 2700
      self.source_locations = {0 :[  17184.165774654884 , -54946.37517183416 , 333.5812953600534 , 1.1495173316749638 ]}

      self.fitter = "dt"
      self.guess_source_location = 0.8864738044875085
      self.event_index = 1
      self.guess_station_delays =   {
#"CS001": 0.0004976821242791993,
"CS002": 0.0,
#"CS003": 0.00028851841897799296,
"CS004": 0.0006403163137629632,
"CS005": 0.000639490880148148,
"CS006": 0.0006453030344567123,
#"CS007": 0.0005687894179034942,
#"CS011": 0.0003571081514992934,
"CS013": 0.0006445157634508324,
"CS017": 0.00012446130449161289,
"CS021": 0.000642320974007207,
"CS024": 0.0006395645969856107,
#"CS026": 0.00013876058661949086,
"CS028": 0.000633434311119959,
"CS030": 0.0006403273132819529,
"CS032": 0.0006381532232592504,
"CS103": 0.0006151662067650443,
#"CS401": 0.0006397217118891962,
"CS501": 0.0006345665671633935,

"RS106": 0.0006258971181792601,
#"RS208": 0.000562859065436516,
#"RS306": 0.0006481790864739563,
"RS305": 0.000653744331350439,
#"RS307": 0.0004005533097162729,
#"RS406": 0.0005276287175373718,
"RS409": 0.0007254640307369197,

"RS407": 0.0007155838079721633,
"RS503": 0.0006638624754183976,
"RS508": 0.0007606344415195409}

#{}"RS205": 0.0006248497925143704,
#{}"RS210": 0.0006373902636471682,
#{}"RS509": 0.0003119284354589922,
}
      '''

      '''no?
      self.source_locations = {0 :[  0.0 , 0.0 , 0.0 , 1.017317015711407 ]}

      self.fitter = "dt"
      self.guess_source_location = 1.017317015711407
      self.event_index = 0
      self.initial_block = 3130
      self.guess_station_delays = {
"CS001": 0.0004976510333621362,
"CS002": 0.0,
"CS003": 0.0002885257344878575,
"CS004": 0.0006402102388694277,
"CS005": 0.0006393965100705067,
"CS006": 0.0006454962282032683,
"CS007": 0.0005688365753568809,
"CS011": 0.0003572787390085229,
"CS013": 0.0006446949413302549,
"CS017": 0.00012458129182990022,
"CS021": 0.0006424081947886931,
"CS024": 0.0006396716142284559,
"CS026": 0.0001389522508010167,
"CS028": 0.0006336362333567789,
"CS030": 0.0006404879449034015,
"CS032": 0.0006382817049358816,
"CS103": 0.0006152675816254394,
"CS201": 0.0006330115211574688,
"CS301": 0.0006413633803355169,
"CS302": 0.0006364927628136785,
"CS401": 0.0006397475771700023,
"CS501": 0.00063475092180972,
"RS106": 0.0006260596131442993,
#{}"RS205": 0.000624985459688754,
"RS208": 0.000562883446960649,
#{}"RS210": 0.0006351593123639018,
"RS306": 0.0006483197933837466,
"RS305": 0.0006538892806735388,
"RS307": 0.00040058848659557124,
"RS310": 0.00034395929953076544,
"RS406": 0.0005278041012108448,
"RS407": 0.0007156343449322245,
"RS409": 0.000725613652390209,
"RS503": 0.0006640556164326906,
"RS508": 0.0007608876568512434,
#{}"RS509": 0.0002884210104482097,
}

      '''


      """
 #real old delays from fitter
'CS001' :  2.220556471439337e-06 , ## diff to guess: -0.0004958672485786252
'CS003' :  1.4066182756553792e-06 , ## diff to guess: -0.0002865109560854994
'CS004' :  4.291528779048316e-07 , ## diff to guess: -0.0006396534977015897
'CS006' :  4.3288152745727013e-07 , ## diff to guess: -0.0006455774414290234
'CS005' :  -2.2092249825192086e-07 , ## diff to guess: -0.0006400111119178786
'CS011' :  -5.879166764075755e-07 , ## diff to guess: -0.0003592230637212653
'CS007' :  4.0087316678298006e-07 , ## diff to guess: -0.000568793345514165
'CS013' :  -1.8077027955596437e-06 , ## diff to guess: -0.0006449193077793366
'CS017' :  -8.438633029735621e-06 , ## diff to guess: -0.00013481465046088099
'CS021' :  9.294664509063219e-07 , ## diff to guess: -0.0006389025300573073
'CS024' :  2.30822882542762e-06 , ## diff to guess: -0.0006406351336562369
'CS026' :  -9.232572217684969e-06 , ## diff to guess: -0.00015148456855839935
'RS305' :  6.888302539890329e-06 , ## diff to guess: -0.0006233312903705204
'RS409' :  7.793067397988162e-06 , ## diff to guess: -0.0005951778777361831
'CS032' :  -1.5785040153880655e-06 , ## diff to guess: -0.0006378156204294484
'CS030' :  -2.7286559656333804e-06 , ## diff to guess: -0.0006390372828220642
'CS103' :  -2.8519617563694718e-05 , ## diff to guess: -0.0006511809388529865
'CS201' :  -1.0490937515827843e-05 , ## diff to guess: -0.0006478272893029173
'CS301' :  -7.359841486519885e-07 , ## diff to guess: -0.000644108931267814
'CS302' :  -5.378904868241638e-06 , ## diff to guess: -0.0006398069996269517
'CS401' :  -9.520022917570206e-07 , ## diff to guess: -0.0006370608606790312
'CS501' :  -9.58873965144872e-06 , ## diff to guess: -0.0006403603069585875
'RS106' :  6.944984301502728e-06 , ## diff to guess: -0.000663342734205106
'RS208' :  6.7697363126754175e-06 , ## diff to guess: -0.0006724966670243665
'RS306' :  6.967436014396598e-06 , ## diff to guess: -0.0006109775886943933
'RS310' :  7.754939149533024e-06 , ## diff to guess: -0.0002581069017984504
'RS307' :  6.685871848156194e-06 , ## diff to guess: -0.0003733950670727287
'RS406' :  7.249988457495066e-06 , ## diff to guess: -0.0004696372948727412
'RS407' :  7.44289143685345e-06 , ## diff to guess: -0.0006580051087558488
'RS503' :  7.011313003361032e-06 , ## diff to guess: -0.0006443901722790714
'RS508' :  7.456872568850128e-06 , ## diff to guess: -0.0007236991407017272
}     """
